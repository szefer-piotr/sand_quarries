Ag.3.5.percent.mar.1.cols.13.table <- 100*Ag.3.5.prop.mar.1.cols.13.table
Ag.3.6.A <- Ag.3.5[c(1,3), c(1,3)]
Ag.3.6.A
Ag.3.5.loglm
# Two rows Herb and Klep that have similar proportions
Ag.3.5.prop.mar.2.rows.12.table <- prop.table(Ag.3.5[1:2,], margin = 2)
# transform to percentages
Ag.3.5.percent.mar.2.rows.12.table <- 100*Ag.3.5.prop.mar.2.rows.12.table
# Two columns Early and Late that have similar proportions
Ag.3.5.prop.mar.1.cols.13.table <- prop.table(Ag.3.5[,c(1,3)], margin = 1)
# transform to percentages
Ag.3.5.percent.mar.1.cols.13.table <- 100*Ag.3.5.prop.mar.1.cols.13.table
Ag.3.6.A <- Ag.3.5[c(1,3), c(1,3)]
Ag.3.6.A
Ag.3.6.A.loglm <- loglm( ~ Stage + Group, data = Ag.3.6.A)
Ag.3.6.A.loglm
# Ho is true, this is homogenous: it is true that its row and column marginal totals contain the information that lie within the individual cells
margin.table(Ag.3.6.A, margin = 1)
# Ho is true, this is homogenous: it is true that its row and column marginal totals contain the information that lie within the individual cells
margin.table(Ag.3.6.A, margin = 2)
Ag.3.6.B <- as.table(matrix(c(margin.table(Ag.3.6.A, margin = 2),
Ag.3.5[2,c(1,3)]),
nrow = 2,
byrow = FALSE,
dimnames = list(Group = c('Herb+Pred', 'Klep'),
Stage = c('Early', 'Late'))))
Ag.3.6.B
Ag.3.6.B <- as.table(matrix(c(margin.table(Ag.3.6.A, margin = 2),
Ag.3.5[2,c(1,3)]),
nrow = 2,
byrow = TRUE,
dimnames = list(Group = c('Herb+Pred', 'Klep'),
Stage = c('Early', 'Late'))))
Ag.3.6.B
Ag.3.6.B.loglm <- loglm( ~  Stage + Group, data = Ag.3.6.B)
Ag.3.6.B.loglm
# Ind val
source("data/data_processing.R")
library(labdsv)
set.seed(123)
# Indicator values
ivs <- indval(asc, clustering = stages$succession, numitr = 9999)
dfr <-data.frame(Cluster = ivs$maxcls,
IndicatorValue = ivs$indcls,
Probability = ivs$pval)
dfr <- dfr[dfr$Probability <= 0.05,]
dfr <- dfr[order(dfr$Cluster), ]
dfr <- with(dfr, dfr[order(-Cluster, IndicatorValue, decreasing = TRUE),])
# Contingency table
gps <- cbind(colnames(asc),groups)
rownames(gps) <- gps[,1]
dfr$group <- gps[rownames(dfr),2]
ct <- table(dfr$Cluster, dfr$group)
rownames(ct) <- c("SI","SII","SIII")
# Decomposition of 3x3 contingency table
# https://rstudio-pubs-static.s3.amazonaws.com/65435_a8b26773b5d64138b6411a5aa306a5b9.html
Ag.3.5.table.entries <- c(ct[1,],  ct[2,],  ct[3,])
Ag.3.5 <- as.table(matrix(Ag.3.5.table.entries, nrow = 3, byrow = TRUE, dimnames = list(Stage = c('Early', 'Mid', 'Late'), Group = c('Herb', 'Klep', 'Pred'))))
Ag.3.5 <- t(Ag.3.5)
addmargins(Ag.3.5)
# Independence between Stage and Group
library(MASS)
Ag.3.5.loglm <- loglm( ~ Stage + Group, data = Ag.3.5)
Ag.3.5.loglm
# Reject the hypothesis that Stage and Group are independent. There is a strong relationship between these two.
# Subtables analysis
# Table 3.3 page 83 Agresti book
# Two rows Herb and Klep that have similar proportions
Ag.3.5.prop.mar.2.rows.12.table <- prop.table(Ag.3.5[1:2,], margin = 2)
# transform to percentages
Ag.3.5.percent.mar.2.rows.12.table <- 100*Ag.3.5.prop.mar.2.rows.12.table
# Two columns Early and Late that have similar proportions
Ag.3.5.prop.mar.1.cols.13.table <- prop.table(Ag.3.5[,c(1,3)], margin = 1)
# transform to percentages
Ag.3.5.percent.mar.1.cols.13.table <- 100*Ag.3.5.prop.mar.1.cols.13.table
Ag.3.6.A <- Ag.3.5[c(1,3), c(1,3)]
Ag.3.6.A
Ag.3.6.A.loglm <- loglm( ~ Stage + Group, data = Ag.3.6.A)
Ag.3.6.A.loglm
# Ho is true, this is homogenous: it is true that its row and column marginal totals contain the information that lie within the individual cells
margin.table(Ag.3.6.A, margin = 2)
Ag.3.6.B <- as.table(matrix(c(margin.table(Ag.3.6.A, margin = 2),
Ag.3.5[2,c(1,3)]),
nrow = 2,
byrow = TRUE,
dimnames = list(Group = c('Herb+Pred', 'Klep'),
Stage = c('Early', 'Late'))))
Ag.3.6.B
Ag.3.6.B.loglm <- loglm( ~  Stage + Group, data = Ag.3.6.B)
Ag.3.6.B.loglm
# H0 rejected - nonhomogenous
Ag.3.6.B.loglm
Ag.3.6.B
Ag.3.6.A
Ag.3.6.B
# present ‘percentages’ table
round(Ag.3.5.percent.mar.1.cols.12.table, 1)
Ag.3.5.percent.mar.2.rows.12.table
Ag.3.5
# Independence between Stage and Group
library(MASS)
Ag.3.5.loglm <- loglm( ~ Stage + Group, data = Ag.3.5)
Ag.3.5.loglm
# Two rows Herb and Klep that have similar proportions
Ag.3.5.prop.mar.2.rows.12.table <- prop.table(Ag.3.5[1:2,], margin = 2)
# transform to percentages
Ag.3.5.percent.mar.2.rows.12.table <- 100*Ag.3.5.prop.mar.2.rows.12.table
# Two columns Early and Late that have similar proportions
Ag.3.5.prop.mar.1.cols.13.table <- prop.table(Ag.3.5[,c(1,3)], margin = 1)
# transform to percentages
Ag.3.5.percent.mar.1.cols.13.table <- 100*Ag.3.5.prop.mar.1.cols.13.table
Ag.3.5.prop.mar.2.rows.12.table
# Two rows Herb and Klep that have similar proportions
Ag.3.5.prop.mar.1.rows.13.table <- prop.table(Ag.3.5[,c(1,3)], margin = 1)
Ag.3.5.prop.mar.1.rows.13.table
# transform to percentages
Ag.3.5.percent.mar.1.rows.13.table <- 100*Ag.3.5.prop.mar.1.rows.13.table
Ag.3.5.percent.mar.1.rows.13.table
# Two rows Herb and Klep that have similar proportions
Ag.3.5.prop.mar.2.rows.12.table <- prop.table(Ag.3.5[1:2,], margin = 2)
# transform to percentages
Ag.3.5.percent.mar.2.rows.12.table <- 100*Ag.3.5.prop.mar.2.rows.12.table
Ag.3.5.percent.mar.2.rows.12.table
# Two rows Herb and Klep vs mid late that have similar proportions
Ag.3.5.prop.mar.2.rows.12.table <- prop.table(Ag.3.5[1:2,], margin = 1)
# transform to percentages
Ag.3.5.percent.mar.2.rows.12.table <- 100*Ag.3.5.prop.mar.2.rows.12.table
Ag.3.5.percent.mar.2.rows.12.table
# Two rows Herb and Klep vs mid late that have similar proportions
Ag.3.5.prop.mar.2.rows.12.table <- prop.table(Ag.3.5[1:2,], margin = 2)
# transform to percentages
Ag.3.5.percent.mar.2.rows.12.table <- 100*Ag.3.5.prop.mar.2.rows.12.table
Ag.3.5.percent.mar.2.rows.12.table
Ag.3.6.A <- Ag.3.5[1:2, 2:3]
Ag.3.6.A
Ag.3.5.prop.mar.2.rows.12.table <- prop.table(Ag.3.5[,1:2], margin = 2)
# transform to percentages
Ag.3.5.percent.mar.2.rows.12.table <- 100*Ag.3.5.prop.mar.2.rows.12.table
Ag.3.5.prop.mar.2.cols.23.table <- prop.table(Ag.3.5[,2:3], margin = 2)
# transform to percentages
Ag.3.5.percent.mar.2.cols.23.table <- 100*Ag.3.5.prop.mar.2.cols.23.table
Ag.3.5.percent.mar.2.cols.23.table
Ag.3.5.prop.mar.1.cols.23.table <- prop.table(Ag.3.5[,2:3], margin = 1)
# transform to percentages
Ag.3.5.percent.mar.1.cols.23.table <- 100*Ag.3.5.prop.mar.1.cols.23.table
Ag.3.5.percent.mar.1.cols.23.table
Ag.3.6.A <- Ag.3.5[1:2, 2:3]
Ag.3.6.A
Ag.3.6.A.loglm <- loglm( ~ Stage + Group, data = Ag.3.6.A)
Ag.3.6.A.loglm
Ag.3.6.A.loglm <- loglm( ~ Group + Stage, data = Ag.3.6.A)
Ag.3.6.A.loglm
Ag.3.6.A
margin.table(Ag.3.6.A, margin = 2)
margin.table(Ag.3.6.A, margin = 1)
Ag.3.6.B <- as.table(matrix(c(margin.table(Ag.3.6.A, margin = 1),
Ag.3.5[1;2, ]),
nrow = 2,
byrow = TRUE,
dimnames = list(Group = c('Herb+Pred', 'Klep'),
Stage = c('Early', 'Late'))))
Ag.3.6.B <- as.table(matrix(c(margin.table(Ag.3.6.A, margin = 1),
Ag.3.5[1:2, ]),
nrow = 2,
byrow = TRUE,
dimnames = list(Group = c('Herb+Pred', 'Klep'),
Stage = c('Early', 'Late'))))
Ag.3.6.B <- as.table(matrix(c(margin.table(Ag.3.6.A, margin = 1),
Ag.3.5[1:2, 1]),
nrow = 2,
byrow = TRUE,
dimnames = list(Group = c('Herb+Pred', 'Klep'),
Stage = c('Early', 'Late'))))
Ag.3.6.B
Ag.3.5[1:2, 1]
Ag.3.5
Ag.3.6.B <- as.table(matrix(c(margin.table(Ag.3.6.A, margin = 1),
Ag.3.5[1:2, 1]),
nrow = 2,
byrow = FALSE,
dimnames = list(Group = c('Herb','Klep'),
Stage = c('Early', 'Mid+Late'))))
Ag.3.6.B
Ag.3.6.B <- as.table(matrix(c(Ag.3.5[1:2, 1],margin.table(Ag.3.6.A, margin = 1)),
nrow = 2,
byrow = FALSE,
dimnames = list(Group = c('Herb','Klep'),
Stage = c('Early', 'Mid+Late'))))
Ag.3.6.B
Ag.3.6.B.loglm <- loglm( ~  Stage + Group, data = Ag.3.6.B)
Ag.3.6.B.loglm
Ag.3.6.A.loglm
#We could start with 2x3 table
Ag.3.5.Herb.Klep.loglm <- loglm( ~ Group + Stage, data = Ag.3.5[1:2, ])
Ag.3.5.Herb.Klep.loglm
Ag.3.6.B.loglm
Ag.3.6.B.loglm
# Seems like first two rows are homogenous. with G^2 = 1.2431761
0.2687561 + 1.2230849
Ag.3.5[1:2, ]
Ag.3.6.B
Ag.3.6.A
Ag.3.6.A.loglm
# Seems like first two rows are homogenous. with G^2 = 1.2431761
0.02009123 + 1.2230849
Ag.3.5.Herb.Klep.loglm
# Seems like first two rows are homogenous. with G^2 = 1.2431761
0.02009123 + 1.2230849
Ag.3.6.B
# Since Ag.3.6.A is homogenous we could compute column marginal totals
Ag.3.6.C <- as.table(matrix(c(margin.table(Ag.3.6.A, margin = 2),
Ag.3.5[3, 2:3]),
nrow = 2,
byrow = TRUE,
dimnames = list(Group = c('Herb+Klep','Pred'),
Stage = c('Mid', 'Late'))))
Ag.3.6.C
Ag.3.6.C.loglm <- loglm( ~  Stage + Group, data = Ag.3.6.C)
Ag.3.6.C.loglm
nrow = 2,
byrow = FALSE,
dimnames = list(Group = c('Herb+Klep','Pred'),
Stage = c('Early', 'Mid+Late'))))
Ag.3.6.D <- as.table(matrix(c(margin.table(Ag.3.6.C, margin = 1),
margin.table(Ag.3.6.B, margin = 2)[2],
Ag.3.5[3,1]),
nrow = 2,
byrow = FALSE,
dimnames = list(Group = c('Herb+Klep','Pred'),
Stage = c('Early', 'Mid+Late'))))
Ag.3.6.D
Ag.3.6.D <- as.table(matrix(c(margin.table(Ag.3.6.C, margin = 1),
margin.table(Ag.3.6.B, margin = 2)[1],
Ag.3.5[3,1]),
nrow = 2,
byrow = FALSE,
dimnames = list(Group = c('Herb+Klep','Pred'),
Stage = c('Early', 'Mid+Late'))))
Ag.3.6.D
Ag.3.6.D <- as.table(matrix(c(margin.table(Ag.3.6.C, margin = 1),
margin.table(Ag.3.6.B, margin = 2)[1],
Ag.3.5[3,1]),
nrow = 2,
byrow = TRUE,
dimnames = list(Group = c('Herb+Klep','Pred'),
Stage = c('Early', 'Mid+Late'))))
Ag.3.6.D
margin.table(Ag.3.6.C, margin = 1)
Ag.3.5[3,1]
margin.table(Ag.3.6.B, margin = 2)[1]
Ag.3.6.D <- as.table(matrix(c(margin.table(Ag.3.6.B, margin = 2)[1],
Ag.3.5[3,1],
margin.table(Ag.3.6.C, margin = 1)),
nrow = 2,
byrow = FALSE,
dimnames = list(Group = c('Herb+Klep','Pred'),
Stage = c('Early', 'Mid+Late'))))
Ag.3.6.D
Ag.3.6.B
margin.table(Ag.3.6.B, margin = 2)[1]
Ag.3.6.D
Ag.3.6.D
Ag.3.6.D.loglm <- loglm( ~  Stage + Group, data = Ag.3.6.D)
Ag.3.6.D.loglm
Ag.3.5.loglm
names(Ag.3.5.loglm)
Ag.3.5.loglm$lrt
Ag.3.6.A.loglm$lrt+
Ag.3.6.B.loglm$lrt+
Ag.3.6.C.loglm$lrt+
Ag.3.6.D.loglm$lrt
Ag.3.5.loglm$lrt =
Ag.3.6.A.loglm$lrt+
Ag.3.6.B.loglm$lrt+
Ag.3.6.C.loglm$lrt+
Ag.3.6.D.loglm$lrt
# Ind val
source("data/data_processing.R")
library(labdsv)
set.seed(123)
# Indicator values
ivs <- indval(asc, clustering = stages$succession, numitr = 9999)
dfr <-data.frame(Cluster = ivs$maxcls,
IndicatorValue = ivs$indcls,
Probability = ivs$pval)
dfr <- dfr[dfr$Probability <= 0.05,]
dfr <- dfr[order(dfr$Cluster), ]
dfr <- with(dfr, dfr[order(-Cluster, IndicatorValue, decreasing = TRUE),])
# Contingency table
gps <- cbind(colnames(asc),groups)
rownames(gps) <- gps[,1]
dfr$group <- gps[rownames(dfr),2]
ct <- table(dfr$Cluster, dfr$group)
rownames(ct) <- c("SI","SII","SIII")
# Decomposition of 3x3 contingency table
# https://rstudio-pubs-static.s3.amazonaws.com/65435_a8b26773b5d64138b6411a5aa306a5b9.html
Ag.3.5.table.entries <- c(ct[1,],  ct[2,],  ct[3,])
Ag.3.5 <- as.table(matrix(Ag.3.5.table.entries, nrow = 3, byrow = TRUE, dimnames = list(Stage = c('Early', 'Mid', 'Late'), Group = c('Herb', 'Klep', 'Pred'))))
Ag.3.5 <- t(Ag.3.5)
addmargins(Ag.3.5)
# Independence between Stage and Group
library(MASS)
Ag.3.5.loglm <- loglm( ~ Stage + Group, data = Ag.3.5)
Ag.3.5.loglm
# Reject the hypothesis that Stage and Group are independent. There is a strong relationship between these two.
# Subtables analysis
# Table 3.3 page 83 Agresti book
# Two rows Herb and Klep vs mid late that have similar proportions
Ag.3.5.prop.mar.2.rows.12.table <- prop.table(Ag.3.5[1:2,], margin = 2)
# transform to percentages
Ag.3.5.percent.mar.2.rows.12.table <- 100*Ag.3.5.prop.mar.2.rows.12.table
Ag.3.6.A <- Ag.3.5[1:2, 2:3]
Ag.3.5.prop.mar.1.cols.23.table <- prop.table(Ag.3.5[,2:3], margin = 1)
# transform to percentages
Ag.3.5.percent.mar.1.cols.23.table <- 100*Ag.3.5.prop.mar.1.cols.23.table
Ag.3.6.A <- Ag.3.5[1:2, 2:3]
Ag.3.6.A.loglm <- loglm( ~ Group + Stage, data = Ag.3.6.A)
Ag.3.6.A.loglm
# Homogenous
margin.table(Ag.3.6.A, margin = 1)
Ag.3.6.B <- as.table(matrix(c(Ag.3.5[1:2, 1],margin.table(Ag.3.6.A, margin = 1)),
nrow = 2,
byrow = FALSE,
dimnames = list(Group = c('Herb','Klep'),
Stage = c('Early', 'Mid+Late'))))
Ag.3.6.B
Ag.3.6.B.loglm <- loglm( ~  Stage + Group, data = Ag.3.6.B)
Ag.3.6.B.loglm
# Homogenous
#We could start with 2x3 table
Ag.3.5.Herb.Klep.loglm <- loglm( ~ Group + Stage, data = Ag.3.5[1:2, ])
Ag.3.5.Herb.Klep.loglm
# Seems like first two rows are homogenous. with G^2 = 1.2431761
# 0.02009123 + 1.2230849
# Since Ag.3.6.A is homogenous we could compute column marginal totals
Ag.3.6.C <- as.table(matrix(c(margin.table(Ag.3.6.A, margin = 2),
Ag.3.5[3, 2:3]),
nrow = 2,
byrow = TRUE,
dimnames = list(Group = c('Herb+Klep','Pred'),
Stage = c('Mid', 'Late'))))
Ag.3.6.C.loglm <- loglm( ~  Stage + Group, data = Ag.3.6.C)
Ag.3.6.C.loglm
# Nonhomogenous - Group and Stage are related
# slopy code
Ag.3.6.D <- as.table(matrix(c(margin.table(Ag.3.6.B, margin = 2)[1],
Ag.3.5[3,1],
margin.table(Ag.3.6.C, margin = 1)),
nrow = 2,
byrow = FALSE,
dimnames = list(Group = c('Herb+Klep','Pred'),
Stage = c('Early', 'Mid+Late'))))
Ag.3.6.D
Ag.3.6.D.loglm <- loglm( ~  Stage + Group, data = Ag.3.6.D)
Ag.3.6.D.loglm
Ag.3.5.loglm$lrt ==
Ag.3.6.A.loglm$lrt+
Ag.3.6.B.loglm$lrt+
Ag.3.6.C.loglm$lrt+
Ag.3.6.D.loglm$lrt
Ag.3.5.loglm$lrt
Ag.3.5.loglm$lrt ==
Ag.3.6.A.loglm$lrt+
Ag.3.6.B.loglm$lrt+
Ag.3.6.C.loglm$lrt+
Ag.3.6.D.loglm$lrt
Ag.3.5.loglm$lrt == (Ag.3.6.A.loglm$lrt+Ag.3.6.B.loglm$lrt+Ag.3.6.C.loglm$lrt+Ag.3.6.D.loglm$lrt)
Ag.3.5.loglm$lrt
(Ag.3.6.A.loglm$lrt+Ag.3.6.B.loglm$lrt+Ag.3.6.C.loglm$lrt+Ag.3.6.D.loglm$lrt)
Ag.3.5.loglm$lrt === (Ag.3.6.A.loglm$lrt+Ag.3.6.B.loglm$lrt+Ag.3.6.C.loglm$lrt+Ag.3.6.D.loglm$lrt)
round(Ag.3.5.loglm$lrt,12) == round((Ag.3.6.A.loglm$lrt+Ag.3.6.B.loglm$lrt+Ag.3.6.C.loglm$lrt+Ag.3.6.D.loglm$lrt),12)
sum(Ag.3.5)
rowSums(Ag.3.5)
colSums(Ag.3.5)
Ag.3.6.A
Ag.3.6.B
Ag.3.6.C
Ag.3.6.D
spc
# Source data processing script ----
source("data/data_processing.R")
library(vegan)
# Transformation
ascnt <- asc
asc <- decostand(asc, "hel")
# 1. RDA ordination ----
rda1 <- rda(asc~as.factor(succession), data=stages)
rdaa <- rda(asc[,groups=="Herbivores"]~as.factor(succession), data=stages)
rdas <- rda(asc[,groups=="Predators"]~as.factor(succession), data=stages)
rdac <- rda(asc[,groups=="Kleptoparasites"]~as.factor(succession), data=stages)
# cca1 <- cca(asc~succession, data=stages)
# m <- cca1
m <- rda1
#>>> Statistical test ----
anova(m, by="terms", permutations = 999)
anova(m, by="axis", permutations = 999)
# both axes are significant
# Succession is a statistically significant factor
# >>> R2 -----
coef(m)
R2 <- RsquareAdj(m)$r.squared
R2
# RDA: Only 12.45 % of the variance explained for the whole dataset
# CCA: Only 10.96 % of the variance explained for the whole dataset
# 2. Variance explained -----
sumeig <- summary(eigenvals(m))
round(sumeig[2,1],3)
round(sumeig[2,2],3)
# >>> goodness of fit ----
# GOF - total inertia explained for given number of axes
# gof <- "goodness"(m, display = "species",
#                   statistic = "explained",
#                   model="CCA",
#                   summarize = FALSE)
# Fit species onto ordination
spc <- envfit(m, asc)
spc
rownames(spc$vectors)[spc$vectors$pvals <= 0.05]
rownames(spc$vectors)
rownames(spc$vectors$pvals)[spc$vectors$pvals <= 0.05]
spc$vectors$pvals
rownames([spc$vectors$pvals <= 0.05])
rownames(spc$vectors$pvals <= 0.05)
spc$vectors$pvals <= 0.05
spc$vectors$pvals[spc$vectors$pvals <= 0.05]
names(spc$vectors$pvals[spc$vectors$pvals <= 0.05])
# Fit species onto ordination
set.seed(1234)
?envfit
spc <- envfit(m, asc, permutations = 9999)
# withouth selection
as.factor(groups)
names(summary(rda1))
which(colnames(asc) == rownames(summary(rda1)$species))
make_rda_plot <- function(m, scl=3, type = "Apiformes", color){
plot(m, type = "n", scaling = scl,
xlab = paste("RDA1 [",
round(sumeig[2,1]*100,2),
"%]",
sep=""),
ylab = paste("RDA2 [",
round(sumeig[2,2]*100,2),
"%]",
sep=""),
cex.lab = 1.5)
points(m, display = "species",
col = colvec[color],
scaling = scl, pch=19, cex = 1.5,
select = colnames(asc[groups == type]))
points(m, display="cn", scaling = scl,
col = "red",
pch = 25)
text(m, display="cn", scaling = scl,
labels = c("Early",
"Mid",
"Late"),
col = "red", lwd=1.5,
pos = 3)
grnames <- colnames(asc[,groups == type])
lgn <- length(selected_gof[selected_gof %in% grnames])
if(lgn != 0){
text(m, display="species", scaling=scl,
select = selected_gof[selected_gof %in% grnames],
col=cgray)
}
}
# pdf("fig2_rda.pdf", width = 12, height = 4)
par(mfrow = c(1,3))
make_rda_plot(m, 3, "Herbivores", 1)
make_rda_plot(m, 3, "Predators", 3)
make_rda_plot(m, 3, "Kleptoparasites", 2)
names(spc$vectors$pvals[spc$vectors$pvals <= 0.05])
groups
gps <- cbind(colnames(asc),groups)
gps
rownames(gps) <- gps[,1]
efs <- names(spc$vectors$pvals[spc$vectors$pvals <= 0.05])
gps[efs, 2]
rownames(gps) %in% efs
gps[!(rownames(gps) %in% efs), 2]
gps[efs, 2]
nss <- gps[!(rownames(gps) %in% efs), 2]
sis <- gps[efs, 2]
table(nss)
table(sis)
table(gps)
table(gps[,2])
table(nss)
table(sis)
gps <- data.frame(Species = colnames(asc), Group = groups)
gps
rownames(gps) <- gps[,1]
gps
gps[!(rownames(gps) %in% efs)]
gps[!(rownames(gps) %in% efs), ]$ns <- "NS"
gps$ns <- "NS"
gps$Significance <- "NS"
gps <- data.frame(Species = colnames(asc), Group = groups)
rownames(gps) <- gps[,1]
gps$Significance <- "NS"
# gps[!(rownames(gps) %in% efs), ]$ns <- "NS"
gps[efs,]$Significance <- "SI"
table(gps$Group,  gps$Significance)
Ag.3.5 <- table(gps$Group,  gps$Significance)
# Two columns Early and Late that have similar proportions
Ag.3.5.prop.mar.1.cols.13.table <- prop.table(Ag.3.5[,c(1,3)], margin = 1)
# Two columns Early and Late that have similar proportions
Ag.3.5.prop.mar.1.cols.13.table <- prop.table(Ag.3.5[,1:2], margin = 1)
# transform to percentages
Ag.3.5.percent.mar.1.cols.13.table <- 100*Ag.3.5.prop.mar.1.cols.13.table
Ag.3.5.percent.mar.1.cols.13.table
Ag.3.5
